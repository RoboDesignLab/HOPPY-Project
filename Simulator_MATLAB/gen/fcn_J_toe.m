function [J_toe] = fcn_J_toe(q,p)

J_toe = zeros(3,4);

  J_toe(1,1)=p(5)*cos(q(3))*sin(q(1))*sin(q(2)) - p(3)*cos(q(2))*sin(q(1)) - p(5)*cos(q(1))*...
         sin(q(3)) - cos(q(4))*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2)))*(p(6)^2 + p(7)^2)^(1/2) - sin(q(4))*...
         (cos(q(1))*cos(q(3)) + sin(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2) - p(4)*cos(q(1));
  J_toe(1,2)=cos(q(1))*cos(q(2))*sin(q(3))*sin(q(4))*(p(6)^2 + p(7)^2)^(1/2) - p(5)*cos(q(1))*...
         cos(q(2))*cos(q(3)) - cos(q(1))*cos(q(2))*cos(q(3))*cos(q(4))*(p(6)^2 + p(7)^2)^(1/2) - p(3)*cos(q(1))*sin(q(2));
  J_toe(1,3)=sin(q(4))*(sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2)))*(p(6)^2 +...
          p(7)^2)^(1/2) - cos(q(4))*(cos(q(3))*sin(q(1)) - cos(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2) - p(5)*cos(q(3))*...
         sin(q(1)) + p(5)*cos(q(1))*sin(q(2))*sin(q(3));
  J_toe(1,4)=sin(q(4))*(sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2)))*(p(6)^2 +...
          p(7)^2)^(1/2) - cos(q(4))*(cos(q(3))*sin(q(1)) - cos(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2);
  J_toe(2,1)=p(3)*cos(q(1))*cos(q(2)) - p(4)*sin(q(1)) - p(5)*sin(q(1))*sin(q(3)) - cos(q(4))*...
         (sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2)))*(p(6)^2 + p(7)^2)^(1/2) - sin(q(4))*(cos(q(3))*...
         sin(q(1)) - cos(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2) - p(5)*cos(q(1))*cos(q(3))*sin(q(2));
  J_toe(2,2)=cos(q(2))*sin(q(1))*sin(q(3))*sin(q(4))*(p(6)^2 + p(7)^2)^(1/2) - p(5)*cos(q(2))*...
         cos(q(3))*sin(q(1)) - cos(q(2))*cos(q(3))*cos(q(4))*sin(q(1))*(p(6)^2 + p(7)^2)^(1/2) - p(3)*sin(q(1))*sin(q(2));
  J_toe(2,3)=p(5)*cos(q(1))*cos(q(3)) + cos(q(4))*(cos(q(1))*cos(q(3)) + sin(q(1))*sin(q(2))*...
         sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2) - sin(q(4))*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2)))*(p(6)^2 +...
          p(7)^2)^(1/2) + p(5)*sin(q(1))*sin(q(2))*sin(q(3));
  J_toe(2,4)=cos(q(4))*(cos(q(1))*cos(q(3)) + sin(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 +...
          p(7)^2)^(1/2) - sin(q(4))*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2)))*(p(6)^2 + p(7)^2)^(1/2);
  J_toe(3,1)=0;
  J_toe(3,2)=p(5)*cos(q(3))*sin(q(2)) - p(3)*cos(q(2)) - sin(q(2))*sin(q(3))*sin(q(4))*(p(6)^2 +...
          p(7)^2)^(1/2) + cos(q(3))*cos(q(4))*sin(q(2))*(p(6)^2 + p(7)^2)^(1/2);
  J_toe(3,3)=p(5)*cos(q(2))*sin(q(3)) + cos(q(2))*cos(q(3))*sin(q(4))*(p(6)^2 + p(7)^2)^(1/2) +...
          cos(q(2))*cos(q(4))*sin(q(3))*(p(6)^2 + p(7)^2)^(1/2);
  J_toe(3,4)=cos(q(2))*cos(q(3))*sin(q(4))*(p(6)^2 + p(7)^2)^(1/2) + cos(q(2))*cos(q(4))*sin(q(3))*...
         (p(6)^2 + p(7)^2)^(1/2);

 