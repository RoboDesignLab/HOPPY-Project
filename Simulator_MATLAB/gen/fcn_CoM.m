function [CoM] = fcn_CoM(q,p)

CoM = zeros(3,1);

  CoM(1,1)=(p(8)*(p(12)*cos(q(1)) - p(13)*sin(q(1))) - p(10)*(p(19)*(cos(q(3))*...
         sin(q(1)) - cos(q(1))*sin(q(2))*sin(q(3))) - p(20)*(sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2))) + p(4)*...
         sin(q(1)) - p(3)*cos(q(1))*cos(q(2)) + p(5)*sin(q(1))*sin(q(3)) - p(18)*cos(q(1))*cos(q(2)) + p(5)*cos(q(1))*...
         cos(q(3))*sin(q(2))) + p(9)*(p(3)*cos(q(1))*cos(q(2)) - p(16)*sin(q(1)) - p(4)*sin(q(1)) + p(15)*cos(q(1))*...
         cos(q(2)) + p(17)*cos(q(1))*sin(q(2))) - p(11)*(p(4)*sin(q(1)) + p(22)*(cos(q(4))*(cos(q(3))*...
         sin(q(1)) - cos(q(1))*sin(q(2))*sin(q(3))) - sin(q(4))*(sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2)))) - p(23)*...
         (cos(q(4))*(sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2))) + sin(q(4))*(cos(q(3))*sin(q(1)) - cos(q(1))*...
         sin(q(2))*sin(q(3)))) - p(3)*cos(q(1))*cos(q(2)) + p(5)*sin(q(1))*sin(q(3)) - p(21)*cos(q(1))*cos(q(2)) +...
          cos(q(4))*(sin(q(1))*sin(q(3)) + cos(q(1))*cos(q(3))*sin(q(2)))*(p(6)^2 + p(7)^2)^(1/2) + sin(q(4))*...
         (cos(q(3))*sin(q(1)) - cos(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2) + p(5)*cos(q(1))*cos(q(3))*...
         sin(q(2))))/(p(8) + p(9) + p(10) + p(11));
  CoM(2,1)=(p(8)*(p(13)*cos(q(1)) + p(12)*sin(q(1))) + p(10)*(p(19)*(cos(q(1))*cos(q(3)) +...
          sin(q(1))*sin(q(2))*sin(q(3))) - p(20)*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2))) + p(4)*...
         cos(q(1)) + p(3)*cos(q(2))*sin(q(1)) + p(5)*cos(q(1))*sin(q(3)) + p(18)*cos(q(2))*sin(q(1)) - p(5)*cos(q(3))*...
         sin(q(1))*sin(q(2))) + p(9)*(p(4)*cos(q(1)) + p(16)*cos(q(1)) + p(3)*cos(q(2))*sin(q(1)) + p(15)*cos(q(2))*...
         sin(q(1)) + p(17)*sin(q(1))*sin(q(2))) + p(11)*(p(4)*cos(q(1)) + p(22)*(cos(q(4))*(cos(q(1))*cos(q(3)) +...
          sin(q(1))*sin(q(2))*sin(q(3))) - sin(q(4))*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2)))) - p(23)*...
         (cos(q(4))*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2))) + sin(q(4))*(cos(q(1))*cos(q(3)) + sin(q(1))*...
         sin(q(2))*sin(q(3)))) + p(3)*cos(q(2))*sin(q(1)) + p(5)*cos(q(1))*sin(q(3)) + p(21)*cos(q(2))*sin(q(1)) +...
          cos(q(4))*(cos(q(1))*sin(q(3)) - cos(q(3))*sin(q(1))*sin(q(2)))*(p(6)^2 + p(7)^2)^(1/2) + sin(q(4))*...
         (cos(q(1))*cos(q(3)) + sin(q(1))*sin(q(2))*sin(q(3)))*(p(6)^2 + p(7)^2)^(1/2) - p(5)*cos(q(3))*sin(q(1))*...
         sin(q(2))))/(p(8) + p(9) + p(10) + p(11));
  CoM(3,1)=(p(9)*(p(2) - p(3)*sin(q(2)) + p(17)*cos(q(2)) - p(15)*sin(q(2))) + p(8)*(p(2) + p(14)) +...
          p(10)*(p(2) - p(3)*sin(q(2)) - p(18)*sin(q(2)) - p(5)*cos(q(2))*cos(q(3)) + p(20)*cos(q(2))*cos(q(3)) +...
          p(19)*cos(q(2))*sin(q(3))) + p(11)*(p(2) + p(22)*(cos(q(2))*cos(q(3))*sin(q(4)) + cos(q(2))*cos(q(4))*...
         sin(q(3))) + p(23)*(cos(q(2))*cos(q(3))*cos(q(4)) - cos(q(2))*sin(q(3))*sin(q(4))) - p(3)*sin(q(2)) - p(21)*...
         sin(q(2)) - p(5)*cos(q(2))*cos(q(3)) + cos(q(2))*sin(q(3))*sin(q(4))*(p(6)^2 + p(7)^2)^(1/2) - cos(q(2))*cos(q(3))*...
         cos(q(4))*(p(6)^2 + p(7)^2)^(1/2)))/(p(8) + p(9) + p(10) + p(11));

 